<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.com.leyizhuang.app.foundation.dao.WmsToAppOrderDAO">

    <insert id="saveWtaShippingOrderHeader"
            parameterType="cn.com.leyizhuang.app.foundation.pojo.remote.webservice.wms.WtaShippingOrderHeader">
        INSERT INTO inter_wta_order_shipping_header (create_time, end_dt, wh_no, owner_no, task_no, c_task_type, car_no,
                                                     op_status, driver, order_no, send_flag, error_message, send_time)
            SELECT
                #{createTime},
                #{endDt},
                #{whNo},
                #{ownerNo},
                #{taskNo},
                #{cTaskType},
                #{carNo},
                #{opStatus},
                #{driver},
                #{orderNo},
                #{sendFlag},
                #{errorMessage},
                #{sendTime}
            FROM DUAL
            WHERE NOT EXISTS(
                    SELECT 'X'
                    FROM inter_wta_order_shipping_header
                    WHERE task_no = #{taskNo}
            );
    </insert>

    <insert id="saveWtaShippingOrderGoods"
            parameterType="cn.com.leyizhuang.app.foundation.pojo.remote.webservice.wms.WtaShippingOrderGoods">
        INSERT INTO inter_wta_order_shipping_goods ( order_no, task_type,
                                                    task_no, g_code, d_ack_qty, op_status, source_no)
        VALUES ( #{orderNo}, #{taskType},
                               #{taskNo}, #{gCode}, #{dAckQty}, #{opStatus}, #{sourceNo});
    </insert>

    <insert id="saveWtaReturningOrderHeader"
            parameterType="cn.com.leyizhuang.app.foundation.pojo.remote.webservice.wms.WtaReturningOrderHeader">
        insert into inter_wta_return_order_back_header (create_time, back_no, company_id, note, owner_no, po_no, rec_no,
        wh_no)
        SELECT
        #{createTime},
        #{backNo},
        #{companyId},
        #{note},
        #{ownerNo},
        #{poNo},
        #{recNo},
        #{whNo}
        FROM DUAL
        WHERE NOT EXISTS(
        SELECT 'X'
        FROM inter_wta_return_order_back_header
        WHERE po_no = #{poNo}
        );
    </insert>

    <insert id="saveWtaReturningOrderGoods"
            parameterType="cn.com.leyizhuang.app.foundation.pojo.remote.webservice.wms.WtaReturningOrderGoods">
        insert into inter_wta_return_order_back_goods (gcode, rec_id, rec_no, rec_qty)
        values (#{gcode},#{recId},#{recNo},#{recQty});
    </insert>

    <insert id="saveWtaReturnOrderDeliveryClerk"
            parameterType="cn.com.leyizhuang.app.foundation.pojo.remote.webservice.wms.WtaReturnOrderDeliveryClerk">
        INSERT INTO inter_wta_return_order_delivery_clerk (create_time, return_number, c_wh_no, driver)
            SELECT
                #{createTime},
                #{returnNo},
                #{warehouseNo},
                #{driver}
            FROM DUAL
            WHERE NOT EXISTS(
                    SELECT 'X'
                    FROM inter_wta_return_order_delivery_clerk
                    WHERE return_number = #{orderNo}
            );
    </insert>

    <insert id="saveWtaCancelOrderResultEnter"
            parameterType="cn.com.leyizhuang.app.foundation.pojo.remote.webservice.wms.WtaCancelOrderResultEnter">

        INSERT INTO inter_wta_order_result_enter (create_time, order_no, is_cancel, error_message)

            SELECT
                #{createTime},
                #{orderNo},
                #{isCancel},
                #{errorMessage}
            FROM DUAL
            WHERE NOT EXISTS(
                    SELECT 'X'
                    FROM inter_wta_order_result_enter
                    WHERE order_no = #{orderNo}
            );
    </insert>

    <insert id="saveWtaCancelReturnOrderResultEnter"
            parameterType="cn.com.leyizhuang.app.foundation.pojo.remote.webservice.wms.WtaCancelReturnOrderResultEnter">

        INSERT INTO inter_wta_return_order_result_enter (create_time, return_number, is_cancel, error_message)
        SELECT
        #{createTime},
        #{returnNumber},
        #{isCancel},
        #{errorMessage}
        FROM DUAL
        WHERE NOT EXISTS(
        SELECT 'X'
        FROM inter_wta_return_order_result_enter
        WHERE return_number = #{returnNumber}
        );
    </insert>
</mapper>