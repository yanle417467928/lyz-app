<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.com.leyizhuang.app.foundation.dao.DeliveryAddressDAO">

    <resultMap id="DeliveryAddressResult" type="cn.com.leyizhuang.app.foundation.pojo.DeliveryAddressDO">
        <id column="ID" property="id" jdbcType="BIGINT"/>
        <result column="CREATOR_ID" property="creatorId"/>
        <result column="CREATOR_TYPE" property="creatorType"/>
        <result column="CREATE_TIME" property="createTime"/>
        <result column="MODIFIER_ID" property="modifierId"/>
        <result column="MODIFIER_TYPE" property="modifierType"/>
        <result column="MODIFY_TIME" property="modifyTime"/>
        <result column="DELIVERY_NAME" property="deliveryName"/>
        <result column="DELIVERY_PHONE" property="deliveryPhone"/>
        <result column="DELIVERY_CITY" property="deliveryCity"/>
        <result column="DELIVERY_COUNTY" property="deliveryCounty"/>
        <result column="DELIVERY_STREET" property="DELIVERYSTREET"/>
        <result column="DETAILED_ADDRESS" property="detailedAddress"/>
        <result column="VILLAGE_NAME" property="villageName"/>
        <result column="STATUS" property="STATUS"/>
    </resultMap>

    <select id="queryListByCustomerIdAndStatusIsTrue"
            resultType="cn.com.leyizhuang.app.foundation.pojo.response.DeliveryAddressResponse">
        SELECT
            id,
            receiver delivery_name,
            receiver_phone delivery_phone,
            delivery_city delivery_city,
            delivery_county delivery_county,
            delivery_street delivery_street,
            residence_name village_name,
            detailed_address detailed_address
        FROM delivery_address
        WHERE user_id = #{userId}
            AND identity_type = 'CUSTOMER'
            AND status IS TRUE
    </select>
    <select id="queryListByEmployeeIdAndIdentityTypeAndStatusIsTrue"
            resultType="cn.com.leyizhuang.app.foundation.pojo.response.DeliveryAddressResponse">
        SELECT
            id,
            receiver delivery_name,
            receiver_phone delivery_phone,
            delivery_city delivery_city,
            delivery_county delivery_county,
            delivery_street delivery_street,
            residence_name village_name,
            detailed_address detailed_address
        FROM delivery_address
        WHERE user_id = #{userId}
              AND identity_type = #{identityType}
              AND status IS TRUE
    </select>
    <insert id="addDeliveryAddress" parameterType="cn.com.leyizhuang.app.foundation.pojo.DeliveryAddressDO">
        INSERT INTO delivery_address
        (CREATOR_ID, CREATOR_TYPE, CREATE_TIME, MODIFIER_ID, MODIFIER_TYPE, MODIFY_TIME,
         DELIVERY_NAME, DELIVERY_PHONE, DELIVERY_CITY, DELIVERY_COUNTY, DELIVERY_STREET,
         DETAILED_ADDRESS, VILLAGE_NAME, CUSTOMER_ID, STATUS)
        VALUES
            (#{creatorId}, #{creatorType}, #{createTime}, #{modifierId}, #{modifierType}, #{modifyTime},
                           #{deliveryName}, #{deliveryPhone}, #{deliveryCity}, #{deliveryCounty}, #{deliveryStreet},
             #{detailedAddress}, #{villageName}, #{customerId}, #{status})
    </insert>

    <update id="modifyDeliveryAddress" parameterType="cn.com.leyizhuang.app.foundation.pojo.DeliveryAddressDO">
        UPDATE delivery_address
        <set>
            <if test="null != modifierId">
                MODIFIER_ID = #{modifierId},
            </if>
            <if test="null != modifierType">
                MODIFIER_TYPE = #{modifierType},
            </if>
            <if test="null != modifyTime">
                MODIFY_TIME = #{modifyTime},
            </if>
            <if test="null != deliveryName">
                DELIVERY_NAME = #{deliveryName},
            </if>
            <if test="null != deliveryPhone">
                DELIVERY_PHONE = #{deliveryPhone},
            </if>
            <if test="null != deliveryCity">
                DELIVERY_CITY = #{deliveryCity},
            </if>
            <if test="null != deliveryCounty">
                DELIVERY_COUNTY = #{deliveryCounty},
            </if>
            <if test="null != deliveryStreet">
                DELIVERY_STREET = #{deliveryStreet},
            </if>
            <if test="null != detailedAddress">
                DETAILED_ADDRESS = #{detailedAddress},
            </if>
            <if test="null != villageName">
                VILLAGE_NAME = #{villageName},
            </if>
            <if test="null != status">
                STATUS = #{status},
            </if>
        </set>
        WHERE ID = #{id}
    </update>


</mapper>